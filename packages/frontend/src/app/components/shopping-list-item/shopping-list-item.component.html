<ion-item class="shopping-list-item">
  <ion-checkbox
    labelPlacement="end"
    justify="start"
    [checked]="completed"
    (ionChange)="onComplete()"
  >
    <div class="ion-checkbox-label ion-text-wrap">
      {{ title }}
      @if (recipeTitle) {
        <p>
          {{ "components.shoppingListItem.recipe" | translate }}
          <span>{{ recipeTitle }}</span>
        </p>
      }
      @if (createdAt) {
        <p>
          {{ "components.shoppingListItem.added" | translate }}
          <span>{{ formatItemCreationDate(createdAt) }}</span>
        </p>
      }
      @if (ownerName) {
        <p>
          {{ "components.shoppingListItem.addedBy" | translate }}
          <span>{{ ownerName }}</span>
        </p>
      }
    </div>
  </ion-checkbox>
  @if (showDeleteButton) {
    <ion-button
      slot="end"
      style="icon-only"
      fill="clear"
      color="danger"
      (click)="deleteClick.emit()"
    >
      <ion-icon slot="icon-only" icon="trash"></ion-icon>
    </ion-button>
  }
  @if (!hideRecategorizeButton) {
    <ion-button
      slot="end"
      style="icon-only"
      fill="clear"
      (click)="showMoveToPopover($event)"
    >
      <ion-icon slot="icon-only" icon="ellipsis-vertical"></ion-icon>
    </ion-button>
  }
  <ion-popover
    #moveToPopover
    [isOpen]="moveToPopoverIsOpen"
    (didDismiss)="moveToPopoverIsOpen = false"
  >
    <ng-template>
      <ion-content>
        <ion-list>
          <ion-list-header>
            {{ "components.shoppingListItem.moveTo" | translate }}
          </ion-list-header>
          @for (i18n of builtinCategories; track i18n) {
            <ion-item
              fill="clear"
              (click)="moveToPopoverIsOpen = false; moveToCategoryI18n(i18n)"
              button
              detail="true"
            >
              <ion-label>
                {{ i18n | translate }}
              </ion-label>
            </ion-item>
          }
          @for (userCatTitle of userKnownCategories; track userCatTitle) {
            <ion-item
              fill="clear"
              (click)="
                moveToPopoverIsOpen = false; moveToCategoryCustom(userCatTitle)
              "
              button
              detail="true"
            >
              <ion-label>
                {{ userCatTitle }}
              </ion-label>
            </ion-item>
          }
          <ion-item
            fill="clear"
            (click)="moveToPopoverIsOpen = false; showMoveToArbitraryInput()"
            button
            detail="true"
          >
            <ion-label>
              {{ "components.shoppingListItem.moveToCustom" | translate }}
            </ion-label>
          </ion-item>
        </ion-list>
      </ion-content>
    </ng-template>
  </ion-popover>
</ion-item>
